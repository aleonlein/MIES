
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>ZeroMQ XOP &#8212; MIES Igor (master) Release_2.0_20190602-690-ga3abefd0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxcontrib-images/LightBox2/lightbox2/css/lightbox.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/sphinxcontrib-images/LightBox2/lightbox2/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/sphinxcontrib-images/LightBox2/lightbox2/js/lightbox.min.js"></script>
    <script type="text/javascript" src="_static/sphinxcontrib-images/LightBox2/lightbox2-customize/jquery-noconflict.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/sidebar.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Labnotebook documentation for developers" href="labnotebook-docs.html" />
    <link rel="prev" title="Async Framework" href="asyncframework.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="labnotebook-docs.html" title="Labnotebook documentation for developers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="asyncframework.html" title="Async Framework"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MIES Igor (master) Release_2.0_20190602-690-ga3abefd0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="zeromq-xop">
<h1>ZeroMQ XOP<a class="headerlink" href="#zeromq-xop" title="Permalink to this headline">¶</a></h1>
<p>The ZeroMQ XOP allows to interface with Igor Pro over the network using <a class="reference external" href="http://www.zeromq.org">ZeroMQ</a> as messaging layer and <a class="reference external" href="http://www.json.org">JSON</a> as message format.</p>
<p>The XOP provides the following functions:</p>
<ul class="simple">
<li><a class="reference internal" href="file/interface_8h.html#_CPPv321zeromq_client_connect6string" title="zeromq_client_connect"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_client_connect()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv318zeromq_client_recvv" title="zeromq_client_recv"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_client_recv()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv318zeromq_client_send6string" title="zeromq_client_send"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_client_send()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv318zeromq_server_bind6string" title="zeromq_server_bind"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_server_bind()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv318zeromq_server_recvP6string" title="zeromq_server_recv"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_server_recv()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv318zeromq_server_send6string6string" title="zeromq_server_send"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_server_send()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv320zeromq_handler_startv" title="zeromq_handler_start"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_handler_start()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv319zeromq_handler_stopv" title="zeromq_handler_stop"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_handler_stop()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv311zeromq_stopv" title="zeromq_stop"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_stop()</span></code></a></li>
<li><a class="reference internal" href="file/interface_8h.html#_CPPv310zeromq_set8variable" title="zeromq_set"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">zeromq_set()</span></code></a></li>
</ul>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="windows">
<h3>Windows<a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Quit Igor Pro</li>
<li>Install the vcredist packages in “output/win”</li>
<li>Create the following shortcuts in “$HOME\Documents\WaveMetrics\Igor Pro 7 User Files”<ul>
<li>In “Igor Procedures” a shortcut pointing to “procedures”</li>
<li>In “Igor Help Files” a shortcut pointing to “help”</li>
<li>In “Igor Extensions” a shortcut pointing to “output/win/x86”</li>
<li>In “Igor Extensions (64-bit)” a shortcut pointing to “output/win/x64”</li>
</ul>
</li>
<li>Start Igor Pro</li>
</ul>
</div>
<div class="section" id="macosx">
<h3>MacOSX<a class="headerlink" href="#macosx" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Quit Igor Pro</li>
<li>Unzip the files in “output/mac”</li>
<li>Create the following symbolic links (symlinks) in “$HOME/Documents/WaveMetrics/Igor Pro 7 User Files”<ul>
<li>In “Igor Procedures” a symlink pointing to “procedures”</li>
<li>In “Igor Help Files” a symlink pointing to “help”</li>
<li>In “Igor Extensions” a symlink pointing to “output/mac/ZeroMQ”</li>
<li>In “Igor Extensions (64-bit)” a symlink pointing to “output/mac/ZeroMQ-64”</li>
</ul>
</li>
<li>Start Igor Pro</li>
</ul>
<p>In the following the JSON message format is discussed.</p>
</div>
</div>
<div class="section" id="direction-world-igor-pro">
<h2>Direction: World -&gt; Igor Pro<a class="headerlink" href="#direction-world-igor-pro" title="Permalink to this headline">¶</a></h2>
<div class="section" id="call-igor-pro-functions-and-return-the-result">
<h3>Call Igor Pro functions and return the result<a class="headerlink" href="#call-igor-pro-functions-and-return-the-result" title="Permalink to this headline">¶</a></h3>
<p>Supported parameter types:</p>
<ul class="simple">
<li>string (including pass-by-reference)</li>
<li>variable (including pass-by-reference)</li>
<li>datafolder reference</li>
</ul>
<p>Supported return types:</p>
<ul class="simple">
<li>string</li>
<li>variable</li>
<li>wave (without wave reference waves or datafolder reference waves)</li>
<li>datafolder reference</li>
</ul>
<p>Current <code class="docutils literal notranslate"><span class="pre">CallFunction</span></code> limitations:</p>
<ul class="simple">
<li>Filling in optional parameters is not supported.</li>
<li>Passing wave/structure parameters is not supported.</li>
</ul>
<p>The Igor Pro function <code class="docutils literal notranslate"><span class="pre">FooBar(string</span> <span class="pre">panelTitle,</span> <span class="pre">variable</span> <span class="pre">index)</span></code> can
be called by sending the following string</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;version&quot;</span>   <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="nt">&quot;messageID&quot;</span> <span class="p">:</span> <span class="s2">&quot;my first message&quot;</span><span class="p">,</span>
   <span class="nt">&quot;CallFunction&quot;</span> <span class="p">:</span> <span class="p">{</span>
     <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;FooBar&quot;</span><span class="p">,</span>
     <span class="nt">&quot;params&quot;</span> <span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;ITC18USB_DEV_0&quot;</span><span class="p">,</span>
        <span class="mi">1</span>
     <span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Calling a function without parameters:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;version&quot;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
   <span class="nt">&quot;CallFunction&quot;</span> <span class="p">:</span> <span class="p">{</span>
     <span class="nt">&quot;name&quot;</span> <span class="p">:</span> <span class="s2">&quot;FooBarWithoutArgs&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Possible responses:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;errorCode&quot;</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;result&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span> <span class="p">:</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span>
    <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">4711</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;errorCode&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="nt">&quot;msg&quot;</span> <span class="p">:</span> <span class="s2">&quot;Function does not exist&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the function has pass-by-reference parameters their results are
returned as</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;errorCode&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;passByReference&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;4711&quot;</span><span class="p">,</span>
      <span class="s2">&quot;hi there&quot;</span>
  <span class="p">],</span>
  <span class="nt">&quot;result&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span>
      <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">42</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Functions can also return datafolder references</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;errorCode&quot;</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;result&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span>  <span class="p">:</span> <span class="s2">&quot;dfref&quot;</span><span class="p">,</span>
    <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="s2">&quot;root:MIES&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">result.value</span></code> can also be <code class="docutils literal notranslate"><span class="pre">free</span></code> or <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
<div class="section" id="functions-returning-waves">
<h4>Functions returning waves<a class="headerlink" href="#functions-returning-waves" title="Permalink to this headline">¶</a></h4>
<p>Example wave contents (rows are vertical, colums are horizontal)</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>5</td>
<td>8</td>
</tr>
<tr class="row-even"><td>6</td>
<td>-inf</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>Waves with standard settings only:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;errorCode&quot;</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;result&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span>  <span class="p">:</span> <span class="s2">&quot;wave&quot;</span><span class="p">,</span>
    <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span>     <span class="p">:</span> <span class="s2">&quot;NT_FP64&quot;</span><span class="p">,</span>
      <span class="nt">&quot;dimSize&quot;</span>  <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
      <span class="nt">&quot;date&quot;</span>     <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;modification&quot;</span> <span class="p">:</span> <span class="mi">10221232</span>
        <span class="p">},</span>
      <span class="nt">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;raw&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;-inf&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In case the function returned an invalid wave reference <code class="docutils literal notranslate"><span class="pre">$&quot;&quot;</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;errorCode&quot;</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;result&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span>  <span class="p">:</span> <span class="s2">&quot;wave&quot;</span><span class="p">,</span>
    <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="kc">null</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following is an example where all additional settings are present
because they differ from their default values:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;errorCode&quot;</span> <span class="p">:</span> <span class="p">{</span>
   <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">&quot;result&quot;</span> <span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span>  <span class="p">:</span> <span class="s2">&quot;wave&quot;</span><span class="p">,</span>
    <span class="nt">&quot;value&quot;</span> <span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span>     <span class="p">:</span> <span class="s2">&quot;NT_FP64&quot;</span><span class="p">,</span>
      <span class="nt">&quot;date&quot;</span>     <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;modification&quot;</span> <span class="p">:</span> <span class="mi">10221232</span>
        <span class="p">},</span>
      <span class="nt">&quot;data&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;raw&quot;</span>       <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;-inf&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
         <span class="nt">&quot;unit&quot;</span>      <span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
         <span class="nt">&quot;fullScale&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
        <span class="p">},</span>
      <span class="nt">&quot;dimension&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;size&quot;</span>  <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
         <span class="nt">&quot;delta&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
         <span class="nt">&quot;offset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e5</span><span class="p">,</span> <span class="mf">3e7</span><span class="p">],</span>
         <span class="nt">&quot;unit&quot;</span>  <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;kHz&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">],</span>
         <span class="nt">&quot;label&quot;</span> <span class="p">:</span> <span class="p">{</span>
           <span class="nt">&quot;full&quot;</span>  <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;some name&quot;</span><span class="p">,</span> <span class="s2">&quot;blah&quot;</span> <span class="p">],</span>
           <span class="nt">&quot;each&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;...&quot;</span> <span class="p">]</span>
          <span class="p">}</span>
      <span class="p">},</span>
       <span class="nt">&quot;note&quot;</span> <span class="p">:</span> <span class="s2">&quot;Hi there I&#39;m a nice wave note and are encoded in \&quot;UTF8\&quot;. With fancy things like ï or ß.&quot;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="direction-igor-pro-world">
<h2>Direction: Igor Pro -&gt; World<a class="headerlink" href="#direction-igor-pro-world" title="Permalink to this headline">¶</a></h2>
<p>not yet implemented</p>
</div>
<div class="section" id="specification">
<h2>Specification<a class="headerlink" href="#specification" title="Permalink to this headline">¶</a></h2>
<p>Messages consist of JSON <a class="reference external" href="https://tools.ietf.org/html/rfc7158">RFC7158</a>
encoded strings with one speciality.  <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, <code class="docutils literal notranslate"><span class="pre">Inf</span></code> and <code class="docutils literal notranslate"><span class="pre">-Inf</span></code> are not
supported by JSON, so we encode these non-normal numbers as strings, e.g.
<code class="docutils literal notranslate"><span class="pre">&quot;NaN&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;Inf&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;+Inf&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-Inf&quot;</span></code> (case insensitive).</p>
<div class="section" id="sent-json-message">
<h3>Sent JSON message<a class="headerlink" href="#sent-json-message" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="19%" />
<col width="17%" />
<col width="41%" />
<col width="7%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">JSON type</th>
<th class="head">Value</th>
<th class="head">Description</th>
<th class="head">Required</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>version</td>
<td>string</td>
<td><code class="docutils literal notranslate"><span class="pre">v1</span></code></td>
<td>global for the complete interface</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>operation</td>
<td>object</td>
<td><code class="docutils literal notranslate"><span class="pre">CallFunction</span></code></td>
<td>operation which should be performed</td>
<td>Yes</td>
</tr>
<tr class="row-even"><td>CallFunction.name</td>
<td>string</td>
<td>non-empty</td>
<td>ProcGlobal function without module and or independent
module specification, i.e. without <code class="docutils literal notranslate"><span class="pre">#</span></code>.</td>
<td>Yes</td>
</tr>
<tr class="row-odd"><td>CallFunction.params</td>
<td>array of strings/numbers</td>
<td>holds strings/numbers</td>
<td>function parameters, conversion will be done eagerly.</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="received-json-message-for-operation-callfunction">
<h3>Received JSON message for operation <code class="docutils literal notranslate"><span class="pre">CallFunction</span></code><a class="headerlink" href="#received-json-message-for-operation-callfunction" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="16%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">JSON type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>errorCode.value</td>
<td>number</td>
<td>indicates the success/error of the operation, see <a class="reference internal" href="file/_zero_m_q___interop_8ipf.html#_CPPv311REQ_SUCCESS" title="REQ_SUCCESS"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">REQ_SUCCESS</span></code></a></td>
</tr>
<tr class="row-odd"><td>errorCode.msg</td>
<td>string</td>
<td>human readable error message, only set if errorCode.value != 0</td>
</tr>
<tr class="row-even"><td>return.type</td>
<td>string</td>
<td>type of the function result, one of <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">variable</span></code>, <code class="docutils literal notranslate"><span class="pre">wave</span></code> or <code class="docutils literal notranslate"><span class="pre">dfref</span></code>, only for errorCode.value</td>
</tr>
<tr class="row-odd"><td>return.value</td>
<td>number, string or object</td>
<td>function result, only for errorCode.value == 0</td>
</tr>
<tr class="row-even"><td>return.passByReference</td>
<td>array of strings</td>
<td>Changed parameter values for pass-by-reference parameters.
The fact that <code class="docutils literal notranslate"><span class="pre">passByReference</span></code> is an array of strings is an implementation detail and subject to change.</td>
</tr>
</tbody>
</table>
<p>Functions returning waves:</p>
<ul class="simple">
<li>For now the wave data is always returned in a stringified version in
the reply message itself. Possible enhancement later: Return the
wave’s raw data in binary format in a follow-up message (using zmq’s
multipart message feature).</li>
<li>Data of text waves and the wave note are encoded in UTF-8.</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="13%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">JSON type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>result.value.type</td>
<td>string</td>
<td>wave type; one of NT_FP32, NT_FP64, NT_I8, NT_I16, NT_I32, NT_I64, TEXT_WAVE_TYPE; or’ed with NT_UNSIGNED or NT_CMPLX if needed</td>
</tr>
<tr class="row-odd"><td>result.value.dimension.size</td>
<td>array of 1 to 4 numbers</td>
<td>either “32-bit unsigned int” or “64-bit unsigned int” depending on Igor bitness. An empty wave has <code class="docutils literal notranslate"><span class="pre">[0]</span></code>.</td>
</tr>
<tr class="row-even"><td>result.value.dimension.delta</td>
<td>array of 1 to 4 numbers</td>
<td>delta values for each dimension</td>
</tr>
<tr class="row-odd"><td>result.value.dimension.offset</td>
<td>array of 1 to 4 numbers</td>
<td>offset values for each dimension</td>
</tr>
<tr class="row-even"><td>result.value.dimension.label.full</td>
<td>array of strings</td>
<td>dimension labels for the full dimension</td>
</tr>
<tr class="row-odd"><td>result.value.dimension.label.each</td>
<td>array of strings</td>
<td>dimension labels for each row/column/layer/chunk, colum-major format as <code class="docutils literal notranslate"><span class="pre">result.value.data.raw</span></code></td>
</tr>
<tr class="row-even"><td>result.value.dimension.unit</td>
<td>string</td>
<td>arbitrary string  denoting the unit. The contents are most likely SI with prefix, but this is not guaranteed.</td>
</tr>
<tr class="row-odd"><td>result.value.date.modification</td>
<td>number</td>
<td>time of last modification in seconds since unix epoch in UTC. 0 for free waves.</td>
</tr>
<tr class="row-even"><td>result.value.data.raw</td>
<td>array of numbers/strings</td>
<td>column-major format, read it with <code class="docutils literal notranslate"><span class="pre">np.array([5,</span> <span class="pre">6,</span> <span class="pre">7,</span> <span class="pre">8,</span> <span class="pre">&quot;-inf&quot;,</span> <span class="pre">10]).reshape(3,</span> <span class="pre">2,</span> <span class="pre">order='F')</span></code> using Python.
For complex waves <code class="docutils literal notranslate"><span class="pre">raw</span></code> has two properties <code class="docutils literal notranslate"><span class="pre">real</span></code> and <code class="docutils literal notranslate"><span class="pre">imag</span></code> both holding arrays.</td>
</tr>
<tr class="row-odd"><td>result.value.data.unit</td>
<td>string</td>
<td>arbitrary strings denoting the unit. The contents are most likely SI with prefix, but this is not guaranteed.</td>
</tr>
<tr class="row-even"><td>result.value.data.fullScale</td>
<td>array of numbers/strings</td>
<td>min and max of the data (non-authorative)</td>
</tr>
<tr class="row-odd"><td>result.value.note</td>
<td>string</td>
<td>wave note</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="compilation-instructions">
<h3>Compilation instructions<a class="headerlink" href="#compilation-instructions" title="Permalink to this headline">¶</a></h3>
<p>Required additional software:</p>
<ul class="simple">
<li>(Windows only) Visual Studio 2015</li>
<li>(MacOSX only) Xcode</li>
<li><a class="reference external" href="https://cmake.org">CMake</a> version 3.8 or later</li>
<li><a class="reference external" href="https://www.wavemetrics.com/products/xoptoolkit/xoptoolkit.htm">XOPSupport Toolkit 7</a></li>
<li><a class="reference external" href="https://github.com/byte-physics/igor-unit-testing-framework">Igor Unit Testing Framework</a></li>
</ul>
</div>
</div>
<div class="section" id="building-libzmq">
<h2>Building libzmq<a class="headerlink" href="#building-libzmq" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> libzmq
mkdir build build-64

<span class="c1"># WINDOWS</span>
<span class="c1"># {</span>
<span class="c1"># 32bit</span>
<span class="nb">cd</span> build
cmake -G <span class="s2">&quot;Visual Studio 14 2015&quot;</span> ..
cmake --build . --config Release
ctest -C Release
<span class="c1"># Import/static libs are in lib/release, dll in bin/release</span>

<span class="c1"># 64bit</span>
<span class="nb">cd</span> build-64
cmake -G <span class="s2">&quot;Visual Studio 14 2015 Win64&quot;</span> ..
cmake --build . --config Release
ctest -C Release
<span class="c1"># Import/static libs are in lib/release, dll in bin/release</span>
<span class="c1"># }</span>

<span class="c1"># MACOSX</span>
<span class="c1"># {</span>
<span class="c1"># 32bit</span>
<span class="nb">cd</span> build
cmake -DCMAKE_OSX_ARCHITECTURES<span class="o">=</span>i386 -DCMAKE_OSX_DEPLOYMENT_TARGET<span class="o">=</span><span class="m">10</span>.9 ..
cmake --build . --config Release
ctest -C Release
<span class="c1"># static libs are in lib</span>

<span class="c1"># 64bit</span>
mkdir build-64
<span class="nb">cd</span> build-64
cmake -DCMAKE_OSX_ARCHITECTURES<span class="o">=</span>x86_64 -DCMAKE_OSX_DEPLOYMENT_TARGET<span class="o">=</span><span class="m">10</span>.9 ..
cmake --build . --config Release
ctest -C Release
<span class="c1"># static libs are in lib</span>
<span class="c1"># }</span>
</pre></div>
</div>
</div>
<div class="section" id="building-and-installing-the-zeromq-xop">
<h2>Building and installing the ZeroMQ.xop<a class="headerlink" href="#building-and-installing-the-zeromq-xop" title="Permalink to this headline">¶</a></h2>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Windows</span>
<span class="c1"># {</span>
<span class="c1"># Install cmake from www.cmake.org</span>
<span class="c1"># Install Visual Studio 2015 Community</span>
<span class="c1"># Open a Visual Studio 2015 command prompt</span>
<span class="nb">cd</span> Packages/ZeroMQ/src
mkdir build build-64
cmake -G <span class="s2">&quot;Visual Studio 14 2015&quot;</span> ..
cmake --build . --config Release --target install
<span class="nb">cd</span> ..
cmake -G <span class="s2">&quot;Visual Studio 14 2015 Win64&quot;</span> ..
cmake --build . --config Release --target install
<span class="c1"># }</span>

<span class="c1"># MacOSX</span>
<span class="c1"># {</span>
cmake -DCMAKE_OSX_ARCHITECTURES<span class="o">=</span>i386 -DCMAKE_OSX_DEPLOYMENT_TARGET<span class="o">=</span><span class="m">10</span>.9 -G Xcode ..
cmake --build . --config Release --target install
<span class="nb">cd</span> ..
cmake -DCMAKE_OSX_ARCHITECTURES<span class="o">=</span>x86_64 -DCMAKE_OSX_DEPLOYMENT_TARGET<span class="o">=</span><span class="m">10</span>.9 -G Xcode ..
cmake --build . --config Release --target install
<span class="c1"># }</span>
</pre></div>
</div>
</div>
<div class="section" id="running-the-test-suite">
<h2>Running the test suite<a class="headerlink" href="#running-the-test-suite" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Create in “Igor Procedures” a shortcut pointing to
<code class="docutils literal notranslate"><span class="pre">Packages\unit-testing</span></code></li>
<li>Open Packages/ZeroMQ/tests/RunTests.pxp</li>
<li>Execute in Igor <code class="docutils literal notranslate"><span class="pre">run()</span></code></li>
<li>The test suite always passes <em>without</em> errors</li>
</ul>
</div>
<div class="section" id="running-clang-tidy-on-macosx">
<h2>Running clang-tidy on MacOSX<a class="headerlink" href="#running-clang-tidy-on-macosx" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Install <a class="reference external" href="https://brew.sh">Homebrew</a></li>
<li><code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">llvm</span></code></li>
<li>Create compilation database<ul>
<li><code class="docutils literal notranslate"><span class="pre">mkdir</span> <span class="pre">clang-tidy;</span> <span class="pre">cd</span> <span class="pre">clang-tidy</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">-DCMAKE_OSX_ARCHITECTURES=x86_64</span> <span class="pre">-DCMAKE_OSX_DEPLOYMENT_TARGET=10.9</span> <span class="pre">-DCMAKE_EXPORT_COMPILE_COMMANDS=ON</span> <span class="pre">..</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">cmake</span> <span class="pre">--build</span> <span class="pre">.</span> <span class="pre">--target</span> <span class="pre">clang-tidy</span></code></li>
</ul>
</li>
</ul>
<div class="section" id="zeromq-xop-implementation-details">
<h3>ZeroMQ XOP implementation details<a class="headerlink" href="#zeromq-xop-implementation-details" title="Permalink to this headline">¶</a></h3>
<p>The XOP uses the <code class="docutils literal notranslate"><span class="pre">Dealer</span></code> (called Client in the XOP interface) and <code class="docutils literal notranslate"><span class="pre">Router</span></code> (called Server in the XOP interface) socket types.</p>
<p>The default socket options are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ZMQ_LINGER</span></code>           = <code class="docutils literal notranslate"><span class="pre">0</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ZMQ_SNDTIMEO</span></code>         = <code class="docutils literal notranslate"><span class="pre">0</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ZMQ_RCVTIMEO</span></code>         = <code class="docutils literal notranslate"><span class="pre">0</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ZMQ_ROUTER_MANDATORY</span></code> = <code class="docutils literal notranslate"><span class="pre">1</span></code> (<code class="docutils literal notranslate"><span class="pre">Router</span></code> only)</li>
<li><code class="docutils literal notranslate"><span class="pre">ZMQ_MAXMSGSIZE</span></code>       = <code class="docutils literal notranslate"><span class="pre">1024</span></code> (in bytes, <code class="docutils literal notranslate"><span class="pre">Router</span></code> only)</li>
<li><code class="docutils literal notranslate"><span class="pre">ZMQ_IDENTITY</span></code>         = <code class="docutils literal notranslate"><span class="pre">zeromq</span> <span class="pre">xop:</span> <span class="pre">dealer</span></code> (<code class="docutils literal notranslate"><span class="pre">Dealer</span></code> only)</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Router</span></code>/Server expects three frames (identity, empty, payload) and the
<code class="docutils literal notranslate"><span class="pre">Dealer</span></code>/Client expects two frames (empty, payload) when sending/receiving
messages. This format is used to be compatible with REP/REQ sockets.</p>
<p>The passed function in the JSON message is currently always executed in the
main thread during <code class="docutils literal notranslate"><span class="pre">IDLE</span></code> events. <code class="docutils literal notranslate"><span class="pre">IDLE</span></code> events are generated by Igor Pro
only when no functions are running. In case you want to execute a function
during the time when functions are running the operation <code class="docutils literal notranslate"><span class="pre">DoXOPIdle</span></code> allows
to force an <code class="docutils literal notranslate"><span class="pre">IDLE</span></code> event.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="developers.html">Developer</a></li>
<li class="toctree-l1"><a class="reference internal" href="manualinstallation.html">Manual installation instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="reportingbugs.html">Bug reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasenotes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="grouplist.html">Group list</a></li>
<li class="toctree-l1"><a class="reference internal" href="filelist.html">File list</a></li>
<li class="toctree-l1"><a class="reference internal" href="structlist.html">Struct list</a></li>
<li class="toctree-l1"><a class="reference internal" href="namespacelist.html">Namespace list</a></li>
<li class="toctree-l1"><a class="reference internal" href="CalculateTPLikePropsFromSweep.html">CalculateTPLikePropsFromSweep Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="SweepFormula.html">The Sweep Formula Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="IPNWB.html">Igor Pro module for reading and writing NeurodataWithoutBorder files</a></li>
<li class="toctree-l1"><a class="reference internal" href="TPAnalysis_algorithm.html">Testpulse Analysis Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="asyncframework.html">Async Framework</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ZeroMQ XOP</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#windows">Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="#macosx">MacOSX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#direction-world-igor-pro">Direction: World -&gt; Igor Pro</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#call-igor-pro-functions-and-return-the-result">Call Igor Pro functions and return the result</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#functions-returning-waves">Functions returning waves</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#direction-igor-pro-world">Direction: Igor Pro -&gt; World</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specification">Specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sent-json-message">Sent JSON message</a></li>
<li class="toctree-l3"><a class="reference internal" href="#received-json-message-for-operation-callfunction">Received JSON message for operation <code class="docutils literal notranslate"><span class="pre">CallFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#compilation-instructions">Compilation instructions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-libzmq">Building libzmq</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-and-installing-the-zeromq-xop">Building and installing the ZeroMQ.xop</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-test-suite">Running the test suite</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-clang-tidy-on-macosx">Running clang-tidy on MacOSX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#zeromq-xop-implementation-details">ZeroMQ XOP implementation details</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="labnotebook-docs.html">Labnotebook documentation for developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="epoch_information.html">Epoch Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="mies-concepts.html">Important MIES concepts for developers</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="asyncframework.html"
                        title="previous chapter">Async Framework</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="labnotebook-docs.html"
                        title="next chapter">Labnotebook documentation for developers</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ZeroMQ-XOP-Readme.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="labnotebook-docs.html" title="Labnotebook documentation for developers"
             >next</a> |</li>
        <li class="right" >
          <a href="asyncframework.html" title="Async Framework"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MIES Igor (master) Release_2.0_20190602-690-ga3abefd0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.3.
    </div>
  </body>
</html>